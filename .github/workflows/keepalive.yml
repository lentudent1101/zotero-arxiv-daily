name: Keep Repo Alive (Manual)

on:
  workflow_dispatch: # æ”¯æŒæ‰‹åŠ¨è¿è¡Œ
  schedule:
    - cron: '0 0 */25 * *'  # æ¯ 25 å¤©è¿è¡Œä¸€æ¬¡ï¼ŒUTC æ—¶é—´ 00:00

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # ä¸€å®šè¦æ·»åŠ ï¼Œå¦åˆ™æ— æƒ push æ–‡ä»¶
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Create or update a file to trigger commit
        run: |
          # æ¯æ¬¡å†™å…¥å½“å‰æ—¶é—´ï¼Œç¡®ä¿å†…å®¹æ”¹å˜
          echo "Last updated: $(date -u)" > last_updated.txt

      - name: Commit and push changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'

          git add last_updated.txt

          # æ£€æŸ¥æ˜¯å¦æœ‰å˜æ›´ï¼ˆä¾‹å¦‚å‰åæ—¶é—´æˆ³ä¸åŒï¼‰ï¼Œæ‰æ‰§è¡Œæäº¤
          if ! git diff-index --quiet HEAD; then
            git commit -m "ğŸ”„ keepalive: auto-update on $(date -u)"
            git push
          else
            echo "No changes to commit."
